{"mappings":"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","sources":["node_modules/@parcel/runtime-js/lib/helpers/bundle-manifest.js","node_modules/@parcel/runtime-js/lib/runtime-c91cb1ba40a70dbb.js","node_modules/@parcel/runtime-js/lib/runtime-c7ef47d1fc00bd23.js","node_modules/@parcel/runtime-js/lib/runtime-113ee9eb02833d0c.js","node_modules/@parcel/runtime-js/lib/runtime-2b78f14355bbad53.js","src/main.ts"],"sourcesContent":["\"use strict\";\n\nvar mapping = {};\n\nfunction register(pairs) {\n  var keys = Object.keys(pairs);\n\n  for (var i = 0; i < keys.length; i++) {\n    mapping[keys[i]] = pairs[keys[i]];\n  }\n}\n\nfunction resolve(id) {\n  var resolved = mapping[id];\n\n  if (resolved == null) {\n    throw new Error('Could not resolve bundle with id ' + id);\n  }\n\n  return resolved;\n}\n\nmodule.exports.register = register;\nmodule.exports.resolve = resolve;","require('./helpers/bundle-manifest').register(JSON.parse(\"{\\\"l53ZJ\\\":\\\"index.bdb65eac.js\\\",\\\"c8GOh\\\":\\\"SoundHelix-Song-1.3a87d076.mp3\\\",\\\"1Axcj\\\":\\\"SoundHelix-Song-2.2c8899eb.mp3\\\",\\\"gyL46\\\":\\\"SoundHelix-Song-3.0f2a5557.mp3\\\"}\"));","module.exports = new __parcel__URL__(require('./helpers/bundle-manifest').resolve(\"c8GOh\")).toString();","module.exports = new __parcel__URL__(require('./helpers/bundle-manifest').resolve(\"1Axcj\")).toString();","module.exports = new __parcel__URL__(require('./helpers/bundle-manifest').resolve(\"gyL46\")).toString();","let loaded = false;\n\nfunction inicializa() {\n  const audio = new Audio();\n  const selectKeys = ['Enter', 'Space'];\n\n  let tocandoAgora = 0;\n\n  // Seleciona os elementos com querySelector\n  const form = document.querySelector('form');\n  const em = document.querySelector('em');\n  // const audio = document.querySelector('audio');\n  const select = document.querySelector('select');\n  const canvas = document.querySelector('canvas');\n  const playIcon = document.querySelector<SVGAElement>('#play-icon');\n  const pauseIcon = document.querySelector<SVGElement>('#pause-icon');\n\n  // Usado pra capturar botões\n  function getButton(id: string) {\n    return form?.querySelector<HTMLButtonElement>('#' + id);\n  }\n\n  // Usado pra capturar controles\n  function getInput(id: string) {\n    return form?.querySelector<HTMLInputElement>('#' + id);\n  }\n\n  // Captura botões\n  const play = getButton('play');\n  const anterior = getButton('anterior');\n  const proxima = getButton('proxima');\n\n  const tempo = getInput('tempo');\n  const volume = getInput('volume');\n\n  // Interface da música\n  interface AudioTrack {\n    artist: string;\n    title?: string;\n    album?: string;\n    year?: number;\n    url: string;\n  }\n\n  // Playlist\n  const listaDeMusicas: AudioTrack[] = [\n    { url: new URL('./assets/SoundHelix-Song-1.mp3', import.meta.url).pathname, artist: 'SoundHelix Song 1' },\n    { url: new URL('./assets/SoundHelix-Song-2.mp3', import.meta.url).pathname, artist: 'SoundHelix Song 2' },\n    { url: new URL('./assets/SoundHelix-Song-3.mp3', import.meta.url).pathname, artist: 'SoundHelix Song 3' },\n  ];\n\n  // Adiciona músicas no select\n  listaDeMusicas.forEach((musica, numero) => {\n    select.add(new Option(musica.artist, `${numero}`));\n  });\n\n  /**\n   * Daqui pra baixo tudo é baseado em eventos do DOM\n   * onplay\n   * onpause\n   *\n   * Da pra usar ainda:\n   * onended, ontimeupdate...\n   *\n   * onended: pra passar pra próxima música quando uma terminar\n   * ontimeupdate: pra atualizar o tempo tocando\n   *\n   */\n\n  // Atualiza o slider conforme o audio\n  audio.ontimeupdate = () => {\n    if (tempo) {\n      tempo.value = audio.currentTime.toString();\n\n      const s = tempo.valueAsNumber % 60 | 0;\n      const m = (tempo.valueAsNumber / 60) % 60 | 0;\n      tempo.nextElementSibling!.textContent = `${m < 10 ? '0' : ''}${m}:${\n        s < 10 ? '0' : ''\n      }${s}`;\n    }\n  };\n\n  // Ao arrastar o slider, sincroniza o audio\n  tempo.oninput = () => {\n    audio.currentTime = tempo.valueAsNumber;\n  };\n\n  // Ao arrastar o slider, altera o volume\n  volume.oninput = () => {\n    audio.volume = volume.valueAsNumber / 100;\n\n    volume.nextElementSibling!.textContent = `${volume.valueAsNumber}%`;\n  };\n\n  // Esconde o play e mostra o pause\n  audio.onplay = () => {\n    frameLooper();\n    tempo.max = `${audio.duration}`;\n\n    playIcon.style.display = 'none';\n    pauseIcon.style.display = 'block';\n    \n    em.textContent = listaDeMusicas[tocandoAgora].artist;\n  };\n\n  // Esconde o pause e mostra o play\n  audio.onpause = () => {\n    playIcon.style.display = 'block';\n    pauseIcon.style.display = 'none';\n  };\n\n  // Ao clicar no play, toca a música\n  play.onclick = () => {\n    // Se não tiver nada selecionado\n    if (!select.value) {\n      // Toca a primeira música\n      select.value = '0';      \n      listaDeMusicas[+select.value].url;\n    }\n\n    // Se não tiver nada tocando, da play\n    if (audio.paused) {\n      audio.play();\n      // Se estiver tocando, pausa\n    } else {\n      audio.pause();\n    }\n  };\n\n  // Ao clicar no anterior, toca a música anterior\n  anterior.onclick = () => {\n    // Se a música selecionada não for a primeira da lista\n    if (tocandoAgora > 0) {\n      // Toca a música anterior\n      tocandoAgora--;\n\n      // Se for a primeira da lista, toca a última\n    } else {\n      tocandoAgora = listaDeMusicas.length - 1;\n    }\n\n    select.value = `${tocandoAgora}`;\n\n    audio.src = listaDeMusicas[tocandoAgora].url;\n    audio.play();\n  };\n\n  // Ao clicar no próxima, toca a próxima música\n  proxima.onclick = () => {\n    // Se a música selecionada não for a última da lista\n    if (tocandoAgora < listaDeMusicas.length - 1) {\n      // Toca a próxima música\n      tocandoAgora++;\n\n      // Se não for a última da lista, toca a primeira\n    } else {\n      tocandoAgora = 0;\n    }\n\n    select.value = `${tocandoAgora}`;\n\n    audio.src = listaDeMusicas[tocandoAgora].url;\n    audio.play();\n  };\n\n  // Ao dar 2 cliques em uma música, toca a música\n  select.ondblclick = () => trocaMusica();\n\n  /**\n   * Verifica se a tecla pressionada faz parte da lista\n   * que definimos como teclas selecionáveis.\n   * Caso seja verdade, toca a música.\n   */\n  select.onkeydown = (event) => {\n    if (selectKeys.includes(event.code)) {\n      trocaMusica();\n    }\n  };\n\n  function trocaMusica() {\n    // O + converte str pra int\n    const numero = +select.value;\n\n    audio.src = listaDeMusicas[numero].url;\n    audio.play();\n\n    tocandoAgora = numero;\n  }\n\n  /* ================================== */\n\n  const audioCtx = new AudioContext();\n  const canvasCtx = canvas.getContext('2d');\n\n  audio.src = listaDeMusicas[0].url;\n  audio.crossOrigin = 'anonymous';\n\n  const audioSourceNode = audioCtx.createMediaElementSource(audio);\n\n  const analyserNode = audioCtx.createAnalyser();\n  const bufferLength = analyserNode.frequencyBinCount;\n  const dataArray = new Uint8Array(bufferLength);\n\n  audioSourceNode.connect(analyserNode);\n  analyserNode.connect(audioCtx.destination);\n\n  let bars: number;\n  let barX: number;\n  let barWidth: number;\n  let barHeight: number;\n\n  let render = () => {\n    canvasCtx.clearRect(0, 0, canvas.width, canvas.height);\n    canvasCtx.fillStyle = 'rgba(0, 132, 255, 0.466)';\n    bars = 280;\n    for (let i = 0; i < bars; i++) {\n      barWidth = canvas.width / bars;\n      barX = i * (barWidth + 2);\n      barHeight = -dataArray[i] / 1.6;\n      canvasCtx.fillRect(barX, canvas.height, barWidth, barHeight);\n    }\n  };\n\n  let frameLooper = () => {\n    requestAnimationFrame(frameLooper);\n    analyserNode.getByteFrequencyData(dataArray);\n    render();\n  };\n}\n\nwindow.onload = inicializa;"],"names":["$ef7689007096c8a0$export$6503ec6e8aabbaf","$ef7689007096c8a0$export$f7ad0328861e2f03","$ef7689007096c8a0$var$mapping","pairs","keys","Object","i","length","id","resolved","Error","parcelRequire","register","JSON","parse","$b57b09796bbad116$exports","URL","resolve","import","meta","url","toString","$b923f3ba8c297e07$exports","$9d78173ae5361f6a$exports","window","onload","audio","Audio","selectKeys","tocandoAgora","form","document","querySelector","em","select","canvas","playIcon","pauseIcon","getButton","getInput","play","anterior","proxima","tempo","volume","listaDeMusicas","pathname","artist","trocaMusica","numero","value","src","forEach","musica","add","Option","ontimeupdate","currentTime","s","valueAsNumber","m","nextElementSibling","textContent","oninput","onplay","frameLooper","max","duration","style","display","onpause","onclick","paused","pause","ondblclick","onkeydown","event","includes","code","audioCtx","AudioContext","canvasCtx","getContext","crossOrigin","audioSourceNode","createMediaElementSource","analyserNode","createAnalyser","bufferLength","frequencyBinCount","dataArray","Uint8Array","bars","barX","barWidth","barHeight","connect","destination","requestAnimationFrame","getByteFrequencyData","clearRect","width","height","fillStyle","fillRect","render"],"version":3,"file":"index.bdb65eac.js.map"}